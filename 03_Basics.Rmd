
# R Basics and how to read error messages

![Iris Flower](img/iris.png)

## Basics
<!-- Remove Image and plot borders -->
<!-- Include jQuery -->
```{=html}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
```

```{=html}
<script src="https://kit.fontawesome.com/0e67562c4f.js" crossorigin="anonymous"></script>
<!-- <link rel="stylesheet" href="./img/fontawesome.min.css"> -->
```


```{r}
library(dplyr)
```


R is an object-based language.
The great advantage of that is we can assign values, vectors, text, matrices or almost anything else to variables and access them more easily later.
To do that, we use the $\leftarrow$ like so:  \newline
`x <- c(1, 2, 3)`
Go ahead and try it out!
If you had too much fun assigning variables, you can remove them again from your work environment using the `rm()` command in the Console.
So, if you assign the values 1, 2 and 3 to `x`, you can type `rm(x)` into the console, hit enter and x has disappeared from your environment!

- Execute a line of code with `ctrl + enter` in the editor
    - In console you just need to press `enter`
- Text aka _strings_ need to be put in quotes so it can be recognized as such
    - `some_text <- c("amazing", "wow")`
- Comments can and should be added to your code using the `#`


### Basic Functions I

```{r}
a <- c(1, 2, 3, 4)
b <- c(5, 7, 9, 11)
mean(a)
sd(b)
min(b)
```

### Basic Functions II

```{r}
max(b)
a+b
sum(b)
length(a)
```

### Basic Functions III

```{r}
c <- 3:9
c # look at the variable
range(c)
d <- c(10:15, 20:25)
```

## Basic Functions IV

```{r}
d # look at the variable
d[1] # index
d[d==10]
which(d==12)
```

## Exercise 

Create a vector x with the numbers from 50 to 100 and 150 to 200. 

Find its mean, standard deviation and its range.

What is the 77th number of vector x?

### Solution


- `x <- c(50:100, 150:200)` `r x <- c(50:100, 150:200)` 
- `mean(x), sd(x), range(x) %>% round(2)`: \newline `r c(mean(x), sd(x), range(x)) %>% round(2)`
    - `%>% round(2)` takes the numbers and rounds them up to two decimal points
- `x[77]`: `r x[77]`


### Brainteaser <i class="fa-solid fa-lightbulb" style="color: yellow;"></i>

We define two variables in the following way: 

```{r}
e <- 1:5
f <- 2:5
```

Let's say we want to access the number 5 in both variables. 
How come `e[5]` works but `f[5]` does not? 

## Logic

<br>

- next to numeric and string variables: _boolean_
    - either hold the value **TRUE** or **FALSE** (also 1 or 0 respectively)
- useful for filtering data
    - also for conditional operations and recoding
    
### Logical Examples I

```{r}
a <- 4; b <- 5
a < b # smaller than
a <= 4 # smaller/ equal
a > b # greater than
a >= 3 # greater/ equal
```

### Logical Examples II

```{r}
a == b # double equal sign!!
a != b
c <- TRUE
c
!c
```

### Putting it all together...
#### Exercise

**We want to find out whether the average Petal Length and Sepal Length of iris flowers are different from each other.**

Use what you know to "ask R" if those values are unequal!

Hint: You will need logic, the mean()-function and square brackets. Use **names(iris)** to find all variable names in that data set.

### Solution



- Square bracket indexing with the variable name in quotes \newline
`iris[ , "Sepal.Length"]` \
`iris[ , "Petal.Length"]`
- now we add the mean function around both like this: 
`mean(iris[ , "Sepal.Length"])` \
`mean(iris[ , "Sepal.Length"])`
- Finally we compare the two with the != operator:
`mean(iris[ , "Sepal.Length"]) !=`
`mean(iris[ , "Petal.Length"])` \
`r mean(iris[ , "Sepal.Length"]) != mean(iris[ , "Petal.Length"])`



## Reading Error Messages

Even the most advanced R coder will encounter the occasional error message.
While they are quite helpful and usually lead to being able to solve problems, it can be challenging to learn how to properly read the message in order to actually understand what the problem is.
Therefore, we will look at some of the most common wordings to decipher what R needs so it can understand what we want to do.

Think of error messages not as discouraging faults of your program but rather as invites to help you help R understand what you are trying to achieve.

#### _Error: unexpected 'X' in "Y"_ {-}

This message is fairly straightforward: 
R expected a certain kind of symbol at the place where we put 'X' and is now confused because our input did not match the expectation.

For most Europeans, for example, the most commonly used decimal separator will be a comma.
Since R is an american-built language, however, it expects decimals to be separated with a decimal point while commas indicate separate inputs to a function.
Therefore, when we accidentally input a decimal as '3,141', we will receive the error message _Error: unexpected ',' in "3,"_ because R expected the input to be something like '3.141'.

**Fix: Replace the 'x' in "Y" with something that R can understand.** Or alternatively: Make sure that we meant the input like that. 

#### _Error: object 'A' not found_ {-}

This, too, is pretty understandable message:
The object that you are trying to access and use cannot be found by R.
The most common cause for this error message is probably simply that you misspelled the object name somewhere.
R is case-sensitive, so maybe object _A_ was defined as object _a_?
Maybe the object _vector_ is spelled _vcteor_ in your function?

Moreover, sometimes our thoughts are two steps ahead of our code.
When figuring out how to get a program to work, sometimes we presume that a variable exists just because we need it and forget to define the variable up front.
The same goes if we try to access a variable in a data frame that was maybe defined in a different data frame or as its own vector - it simply cannot be found because we are having R look in the wrong place.

**Fix: Make sure the object name is spelled correctly and was defined prior to using it in a function, calculation or elsewhere.**

This error message also often appears with "function xyz not found".
In this case, we probably forgot to load the package first, which contains that function.
Thus, the fix will likely be to figure out which package contains the function we are trying to use and load it with the `library()` command.


<!-- - Mistakes happen to everyone -->
<!-- - Error messages are often frustrating but helpful  -->
<!-- - Many common "beginner problems" are fairly easy to fix once you understand the error -->
<!-- - Try to think of error messages as invites to help R understand what you are trying to achieve! -->

- ![Pobody's Nerfect](./img/nerfect.webp){#id .class width=auto height=200px}



<!-- ### _Error: unexpected 'X' in "Y"_  -->



<!-- - Pretty straightforward: R expects a certain kind of symbol where 'X' is -->
<!--     - Input did not match the expectation -->

<!-- - For example: Comma as a decimal separator  -->
<!--     - In almost all (american-built) coding, the decimal separator is a point -->
<!--     - Input: '3,141'will receive the error message _Error: unexpected ',' in "3,"_  -->
<!--     - R expected the input to be '3.141' -->

<!-- - $\rightarrow$ **Fix: Replace the 'x' in "Y" with something that R can understand.** -->



<!-- ### _Error: object 'A' not found_  -->



<!-- - Object you are trying to use cannot be found by R -->
<!-- - Most common cause: probably you misspelled the object name somewhere -->
<!--     - R is case-sensitive: was object _A_ defined as _a_? -->
<!--     - Or maybe _vector_ is spelled _vcteor_ in your function? -->
<!-- - Maybe a variable was never defined but now you want to use it? -->
<!--     - Or it was defined in a (different) data frame? -->

<!-- - $\rightarrow$ **Fix: Make sure the object name is spelled correctly and was defined prior to using it in a function, calculation or elsewhere.** -->




<!-- - Also often appears with "function xyz not found" -->
<!-- - In this case, we probably forgot to load the package first, which contains that function -->
<!-- - **Fix: Figure out which package is needed and load it with the `library()` command** -->
<!--     - If you still encounter an error like "there is no package called ‘xyz’", either the name of the package is misspelled or you need to install it first using `install.packages()` -->
    

### _Error_: R does nothing after running a command



- This is not an error message but still very common, especially at the beginning
- Usually, there is a `> ` symbol at the beginning of our console input line 
    - If R is "unfinished" with a command, you see `+ ` instead
- This happens when R can`t work with the command because there is something missing
    - In most cases, this will be closing parentheses
    
- $\rightarrow$ **Fix: Click in your console and use the `Esc` button to cancel the command. Then, look at the code you were trying to run and see if there is some closing statement such as `)` missing and try again.**



- We have not talked about the %>%-pipe in depth, but you will hopefully start to love this tool and use it a lot
- If we end a command with a %>% R will show the same behavior of not executing the code
    - $\rightarrow$ R expects something else after the pipe, so when there's nothing, R is confused ![Wait for it GIF](./img/waitforit.gif){#id .class width=auto height=100px}

- <i class="fa-solid fa-lightbulb" style="color: purple;"></i><i style="color: purple;">When you need help figuring out how a function works, there are several ways to get it. Try typing **?magrittr::\`%>%\`** into your console and hit enter!</i>


## Exercise

Below is some code that has a few problems.

Try to identify them and how they might be fixed. Feel free to test them out if you are not sure!

`Library(greatpackage)` 

`r hide("Solution")`

- `library` should not be capitalized
- "greatpackage" does not exist and can thus not be loaded

`r unhide()`

`mean(coolvariable)` 

`r hide("Solution")`

coolvariable was not defined previously

`r unhide()`

`a <- c(1, 3, 6, 7` 

`r hide("Solution")`

the command is not finished, it needs a closing parentheses

`r unhide()`

`b <- c(2, 4; 6, 8)`

`r hide("Solution")`

we need all commas to separate numbers in a vector, not a semicolon

`r unhide()`


## Wrap-Up & Further Resources
 
<i class="fa-solid fa-anchor" style="color: teal;"></i>
<ul style="color: teal;"> 
<li> Functions work with input inside round brackets, e.g. c(1, 2, 3)</li>
<li> a point **.** is a decimal separator in numbers; a comma **,** seperates input in functions</li>
<li> Logical operators compare data, e.g. 7 > 6 would output TRUE</li>
<li> `#` allows comments in the code</li>
<li> Errors should be invitations to make your code more understandable for R</li>
<li> $\rightarrow$ the better we understand the problem, the better we can fix it! </li>
</ul>


<br>

<i class="fa-solid fa-book" style="color: orange;"></i>
<ul style="color: orange;">
<li> [StackOverflow](https://stackoverflow.com/)</li>
<li> [Discovering Statistics Using R](https://katalog.uni-konstanz.de/libero/WebOpac.cls?VERSION=2&ACTION=DISPLAY&RSN=2222774&DATA=KON&TOKEN=nGIfSiZsIA5826&Z=1&SET=1) Book by Andy Field, available from KIM </li>
</ul>
